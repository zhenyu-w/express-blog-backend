var ee=Object.defineProperty,te=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var N=(a,s,o)=>s in a?ee(a,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[s]=o,j=(a,s)=>{for(var o in s||(s={}))se.call(s,o)&&N(a,o,s[o]);if(I)for(var o of I(s))ne.call(s,o)&&N(a,o,s[o]);return a},M=(a,s)=>te(a,ae(s));import{c as oe,u as ie,f as le,s as re,b as ce,a as ue,_ as _e,e as de}from"./index.d7cf8a03.js";import{f as V,g as A,u as me,T as pe,E as m,F as ge,G as ve,r as fe,o as p,h as b,w as c,x as i,v as C,j as t,M as x,i as d,a9 as he,H as w,aa as ke,ab as xe,y as ye,A as Be,B as Ae,ac as be,ad as Ce,Z as we,$ as Ee,a6 as $e,ae as Le}from"./vendor.479a7dc9.js";/* empty css               *//* empty css              *//* empty css               */import{H as u,j as Se,x as Te,c as Re,s as Fe,a as Ie,p as Ne,m as E}from"./atom-one-dark.185653e8.js";import{C as je}from"./comments.76834e0b.js";import{a as $}from"./article.89825cff.js";import{u as Me}from"./async.8bf78ea0.js";import{p as Ve}from"./purify.es.f60722ef.js";/* empty css               */import"./comment.a2fea787.js";import"./reply.99676f4c.js";const g=a=>(ye("data-v-17d39174"),a=a(),Be(),a),De={key:0},He={class:"article__header"},Oe=g(()=>t("img",{class:"avatar",src:de},null,-1)),Ye={class:"article__infos"},ze=g(()=>t("span",{class:"author"},"\u632F\u5B87",-1)),Ue=g(()=>t("sup",{class:"role-tag"},"\u535A\u4E3B",-1)),Ge={class:"read_total"},Je={class:"article__main"},Pe=["innerHTML"],Ze={class:"pre-next-wrap"},qe={key:0,class:"prev"},Ke=g(()=>t("span",null,"\u4E0A\u4E00\u7BC7\uFF1A",-1)),Qe={key:1,class:"next"},We=g(()=>t("span",null,"\u4E0B\u4E00\u7BC7\uFF1A",-1)),Xe={class:"comment__trigger"},et=Ae("\u67E5\u770B\u8BC4\u8BBA"),tt=g(()=>t("span",null,"\u8BC4\u8BBA\u533A",-1)),at=V({name:"Article"}),st=V(M(j({},at),{setup(a){u.registerLanguage("javascript",Se),u.registerLanguage("html",Te),u.registerLanguage("css",Re),u.registerLanguage("shell",Fe),u.registerLanguage("json",Ie),u.registerLanguage("plaintext",Ne);const s=ie(),o=A(()=>s.isAuthed),D=me(),H=pe(),v=A(()=>Number(D.params.id)),l=m(),O=A(()=>l.value&&le(l.value.create_time,"YYYY\u5E74M\u6708D\u65E5")),L=m("");let y=null;const Y=async()=>{const r=await $.detail(v.value);l.value=r.data;const e=E(r.data.article_text);L.value=Ve.sanitize(e),G()},{trigger:z,loading:U}=Me(Y),G=()=>{y=setTimeout(()=>{$.updateReadNum(l.value.id)},5e3)},J=()=>{y&&(clearTimeout(y),y=null)},P=()=>{const r=new E.Renderer;r.link=function(n,k,_){return`<a class="link" href="${n}" target="_blank" title="${_}">${_}</a>`},r.image=function(n,k,_){return`<a class="img-wrapper" href="${n}" target="_blank" title="${_}"><img src="${n}" alt="${_}"></a>`},E.setOptions({renderer:r,highlight:function(e,n){const k=u.getLanguage(n)?n:"plaintext";return u.highlight(e,{language:k}).value},pedantic:!1,gfm:!0,breaks:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1})},f=m(),h=m(),Z=async()=>{const e=(await $.neighbors(v.value)).data;if(e.length>0)switch(e.length){case 1:const n=e[0];n.id<v.value?f.value=n:h.value=n;break;case 2:f.value=be(e,"id"),h.value=Ce(e,"id");break}},B=m(!1),S=m(),q=()=>{S.value.isEditUserInfoVisible=!0},K=()=>{H.push(`/backend/article/edit/${v.value}`)};return ge(()=>{re(),P(),z(),Z()}),ve(()=>{J()}),(r,e)=>{const n=ce,k=we,_=Ee,T=fe("router-link"),Q=$e,W=Le,R=ue,X=_e;return p(),b(X,null,{default:c(()=>[i(_,{loading:d(U),active:"",avatar:"",paragraph:{rows:20}},{default:c(()=>[l.value?(p(),C("article",De,[t("header",He,[Oe,t("div",Ye,[ze,Ue,t("div",null,[t("time",null,"\u53D1\u5E03\u4E8E"+x(d(O)),1),t("span",Ge,"\u9605\u8BFB\xA0\xA0"+x(l.value.read_num),1)])])]),t("main",Je,[i(n,{"img-src":l.value.poster},null,8,["img-src"]),t("h2",null,x(l.value.article_name),1),t("section",{class:"md-preview",innerHTML:L.value},null,8,Pe)])])):(p(),b(k,{key:1}))]),_:1},8,["loading"]),t("div",Ze,[f.value?(p(),C("div",qe,[i(d(he)),Ke,i(T,{to:`/article/${f.value.id}`},{default:c(()=>[t("span",null,x(f.value.article_name),1)]),_:1},8,["to"])])):w("",!0),h.value?(p(),C("div",Qe,[i(d(ke)),We,i(T,{to:`/article/${h.value.id}`},{default:c(()=>[t("span",null,x(h.value.article_name),1)]),_:1},8,["to"])])):w("",!0),t("div",Xe,[i(Q,{type:"primary",onClick:e[0]||(e[0]=F=>B.value=!0)},{default:c(()=>[et]),_:1})]),i(W,{width:"84%",class:"drawer-comment",visible:B.value,onClose:e[1]||(e[1]=F=>B.value=!1)},{title:c(()=>[tt,i(d(xe),{style:{"margin-left":"10px"},onClick:q})]),default:c(()=>[i(je,{ref_key:"commentsRef",ref:S,"article-id":d(v)},null,8,["article-id"])]),_:1},8,["visible"])])]),aside:c(()=>[d(o)?(p(),b(R,{key:0,class:"icon--aside",icon:"edit",onClick:K})):w("",!0),i(R,{class:"icon--aside icon-message",icon:"leave-message",onClick:e[2]||(e[2]=F=>B.value=!0)})]),_:1})}}}));var ht=oe(st,[["__scopeId","data-v-17d39174"]]);export{ht as default};
